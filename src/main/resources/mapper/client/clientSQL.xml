<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="client">


<insert id="insertClient" parameterType="c">
 		insert into client_db values(client_seq.nextval,#{clientId},#{clientPw},#{clientName},#{clientTel},#{clientAddr}, #{clientEmail},'0',to_char(sysdate,'yyyy-mm-dd'),'3000',#{clientAge})
 	</insert>
 	
 	<!-- DB 컬럼명이랑 VO 변수랑 다르면 AS 꼭쓰자 같으면 안써도된다 -->
 	<select id="checkId" parameterType="c" resultType="c">
 		select CLI_ID as clientId from client_db where CLI_ID=#{clientId}
 	</select>
 	
 	<select id="selectOneClient" parameterType="c" resultType="c">
 		select CLI_ID as clientId, CLI_NO as clientNo, CLI_NAME as clientName, CLI_EMAIL as clientEmail, CLI_TEL as clientTel, CLI_ADDR as clientAddr from client_db where CLI_ID=#{clientId} and CLI_PW=#{clientPw}
 	</select>
 	
 	
 	<insert id="reservationClass" parameterType="r">
 		insert into class_db values(class_db_seq.nextval, #{className},#{classCreator},#{classDescription},#{classPrice},#{classPerson},#{classEnroll})
 	</insert>
 	
 	<select id="getClassInfo" parameterType="r" resultType="r">
 		select cls_no as classNo, cls_name as className, sel_no as classCreator, cls_det as classDescription, cls_price as classPrice, class_person as classPerson, class_enroll as classDate, classStarttime as classStartTime from class_db  where class_enroll>TO_CHAR(SYSDATE,'yyyy-mm-dd')
 	</select>
 	
 	<insert id="setClass_list" parameterType="map">
 		
 		insert into class_list_db (cls_l_no, cls_cli_no, cls_class_no) select class_list_db_seq.nextval, #{clientNo}, #{classNo} from dual where not exists(select cls_class_no as classNo from class_list_db where cls_cli_no=#{clientNo} and cls_class_no=#{classNo})
 	</insert>
 	
 	<select id="getGoods" parameterType="string" resultType="g">
 		select g.gds_no as goodsNo, g.gds_name as goodsName, g.gds_pri as goodsPrice, g.GDS_BCNT as goodsCount, i.FILEPATH as imagePath
from goods_db g, img_db i
where g.gds_no=i.TYPE_NO and i.IMG_TYPE='g' 
<if test="value !=null">
	and g.gds_name like '%'||#{value}||'%'
</if>
order by g.gds_no DESC
 	</select>
 	
 	<insert id="setSubscribe" parameterType="s">
 		insert into subscribe_db values(subscribe_db_seq.nextval, #{subscribeName}, #{subscribeDept},#{subscribePrice})
 	</insert>

</mapper>
